kind: pipeline
name: "Publicação de Site hugo Nordsh"

trigger:
  branch:
    - develop
    - main
  event:
    - push

steps:
  - name: build
    image: klakegg/hugo:alpine
    commands:
      - apk --no-cache update
      - apk add git openssh-client
      - mkdir ~/.ssh/
      - echo "$KEY" > ~/.ssh/id_ed25519.pub
      - chmod 0600 ~/.ssh/id_ed25519.pub*
      - ssh-keyscan -t rsa github.com >> ~/.ssh/known_hosts
      - cat <<EOF>> ~/.ssh/config
          Host *
          StrictHostKeyChecking no
          UserKnownHostsFile=/dev/null
          EOF
      - echo StrictHostKeyChecking no >> ~/.ssh/config
      - chmod 0700 ~/.ssh/config
      - chmod +x push-gh-pages.sh
      - git config --global user.name "Rosthan Silva"
      - git config --global user.email "rosthanlinux@gmail.com"
      - git clone  git@github.com:nordsh/nordsh.github.io.git
      - ls nordsh.github.io